(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9069],{4889:(e,t,a)=>{Promise.resolve().then(a.bind(a,5484))},5484:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var l=a(5155),r=a(2115),s=a(5695);function o(){let[e,t]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[c,u]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),p=(0,s.useRouter)(),h=e=>new Promise((t,a)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=()=>t(l.result),l.onerror=e=>a(e)}),x=async t=>{if(t.preventDefault(),!e.trim()||!a.trim()||!n.trim()||!c)return void alert("Please fill in all fields and upload an image.");let l=null;if(c)try{l=await h(c)}catch(e){console.error("Error converting image to base64:",e),alert("Failed to process image. Please try again.");return}console.log("Request body:",{title:e,description:a,place:n,imageUrl:l});try{let t=await fetch("/api/complaints",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,description:a,place:n,imageUrl:l})});if(!t.ok){let e=await t.text();throw console.error("Response status:",t.status),console.error("Response text:",e),Error("Failed to submit complaint: ".concat(e||"Unknown error"))}let r=await t.json();console.log("Submit response:",r),p.push("/complaint")}catch(e){console.error("Error submitting complaint:",e)}};return(0,l.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:x,children:[(0,l.jsxs)("div",{className:"border rounded-lg p-4 text-center bg-gray-100",children:[d&&(0,l.jsx)("img",{src:d,alt:"Preview",className:"mx-auto w-full max-w-xs h-40 object-cover rounded mb-2"}),(0,l.jsxs)("label",{className:"cursor-pointer underline text-gray-700",children:["Upload Image",(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&(u(a),m(URL.createObjectURL(a)))},className:"hidden"})]})]}),(0,l.jsx)("label",{htmlFor:"title",children:"Title"}),(0,l.jsx)("input",{id:"title",type:"text",placeholder:"Title Name",value:e,onChange:e=>t(e.target.value),className:"w-full border p-2 rounded",required:!0}),(0,l.jsx)("label",{htmlFor:"description",children:"Description"}),(0,l.jsx)("textarea",{id:"description",placeholder:"Description",value:a,onChange:e=>o(e.target.value),className:"w-full border p-2 rounded",required:!0}),(0,l.jsx)("label",{htmlFor:"place",children:"Place"}),(0,l.jsx)("input",{id:"place",type:"text",placeholder:"Place",value:n,onChange:e=>i(e.target.value),className:"w-full border p-2 rounded",required:!0}),(0,l.jsx)("button",{type:"submit",className:"w-full bg-black text-white py-2 rounded",children:"Confirm"})]})}function n(){let e=(0,s.useRouter)();return(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex flex-col relative",children:(0,l.jsxs)("div",{className:"overflow-y-auto flex-1 p-4 pb-36",children:[(0,l.jsxs)("div",{className:"mt-12 mb-6 text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Complaint"}),(0,l.jsx)("h2",{className:"text-lg font-medium text-gray-600 mt-2",children:"Add Details"})]}),(0,l.jsx)("button",{onClick:()=>e.back(),className:"text-xl absolute top-4 left-4 bg-white p-2 rounded-full shadow-md z-10","aria-label":"Go Back",children:"←"}),(0,l.jsx)(o,{})]})})}},5695:(e,t,a)=>{"use strict";var l=a(8999);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1317,7358],()=>t(4889)),_N_E=e.O()}]);